Build and Deployment Workflow
----------------------------
1. Compile C++: Build MainService.exe and UpdaterService.exe in Release mode.
2. Compile MSI: Use the WiX Toolset commands:
  - candle.exe Product.wxs
  - light.exe Product.wixobj -o MyApp_v1.msi
3. Deploy: Install MyApp_v1.msi on the target machine.
4. Test Upgrade:
 - Change the version in Product.wxs to 1.0.1.0
 - Rebuild into MyApp_v2.msi
 - Place MyApp_v2.msi in the folder your Main Service watches.
 - Observe the Main Service notifying the Updater, the Updater spawning the Shadow Process, and the MSI successfully replacing both binaries while in Modern Standby.

5. Check for Modern Standby robustness:
 - Install v1.0.0.0 on a laptop.
 - Place v1.0.1.0 in the download folder.
 - Trigger the update.
 - Immediately close the laptop lid.
 - Wait 2 minutes and open it. If the services are running the new version, your PowerRequest logic and Shadow Copy mechanism worked perfectly.

Final Pro-Tip: Signing
For production, you must sign both .exe files and the .msi with a valid Code Signing Certificate. 
If you don't, the CreateProcess call or the msiexec command might be blocked by Windows SmartScreen or User Account Control (UAC) when running in the background.

Using cl.exe - Commonly Used Flags (The "Secret Sauce")
-------------------------------------------------------
When building production-level software like your Windows Services, you use flags to tell cl.exe exactly how to behave:
/O2 (Optimization): Creates the fastest possible code.
/MT (Static Link): Includes the C Runtime (CRT) inside your .exe. This is critical for your Updater Service because it ensures the app runs on a fresh Windows machine that doesn't have the "Visual C++ Redistributable" installed yet.
/EHsc: Enables standard C++ exception handling.
/DUNICODE: Tells the compiler to treat all strings as wide-character (UTF-16), which is the native format for the Windows API.
/Fe:: Specifies the name and location of the output .exe file.
